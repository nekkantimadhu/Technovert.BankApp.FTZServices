<html>
    <head>
        <title>Saketa</title>
        <link rel="stylesheet" href="EmployeeDirectory.css">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

		
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/solid.css">
	</head>
    <body id="body">
		<div class ="container" id = "container">
        <div class="header">
			<div class="left">
            <div style = "width:15%; margin:0; float:left;"><img src="saketa.png"></div>
            <div class="tag" style="margin:0; float:left;">
			<h2   style ="color:skyblue; margin:8% 0% 0% 15%; width:100%;">Employee Directory</h2>
            <h5 style ="margin:0 ; width:100%; margin-left:15%;">The Ultimate People Directory Experience</h5>
			</div>
			</div>
			<div class="welcome">
				<div class="child1"><h2>Welcome,</h2></div>
				<div class="child2" style ="font-size: 20px;" id="userName"><h3></h3></div>
				<img style = "top : 65px ; "src="Antony.png" class="profile">
			</div>
		</div>
		<hr style="color : black">
		<br>
		<div class="left-div" style ="width: 20%; float:left; height:75%;">
			<div id="left-content">
				<h4>Departments</h4>
				<div id="myData"></div>
				<br>
				<a id="job-view" href="#" onclick="displayAll()"><b>view more</b></a>
				
			</div>
		</div>




		
		<div class="right-div">
			<div class="row1">
				
				<div id="buttonsContainer"></div>
				<br>
				<div class="search-container">
					<form>
					  <label  class="search-label" for="search"><b>Search</b></label>
					  <input  class="search" type="text" placeholder="Enter any Keyword" name="search" id="search" onkeyup="getSearchValue()">
					  <input class="clear" type="reset" value="Clear" onclick="clearAll()">
					
				</div>
				<div class="for-filter">
					  <label for="filter-by"><b>Filter by</b></label>
					  <select onchange="getSearchValue()" name="filter" id="filter">
					  <option value="firstName">FirstName</option>
					  <option value="lastName">LastName</option>
					</select>
					</form>
				</div>
				<button class="open-button" onclick="openForm()">Add Employee</button>
				</div>
				<p class="note"><b>Note:</b>Please use  the advanced filter options to refine your results</p>
				<div class="row2">
					<div id="cardsContainer"></div>
				</div>	
				</div>
		</div>
			<div class="add-employee">
				<div class="form-popup" id="myForm">
					<form class="form-container" id="employee-details" method="POST">
					<h2 class="add-emplyee-heading">Add Employee</h2>
					<div id="left-fields" class="left-details">
						<label class="label" for="fname">FirstName:</label>
					    <div id="FirstNameError"></div>
					    <input type="text" placeholder="Enter First Name" name="fname" id="FirstName" onchange="setPreferredName()"  required>
					  	<label class="label" for="pname">Preferred Name:</label>
					  	<div id="PreferredNameError"></div>
					 	<input type="text" placeholder='Enter Preferred Name' name="pname" id="PreferredName"  required>
						<label  class="label"for="office">Office:</label>
						<div id="OfficeError"></div>
						<input type="text" placeholder="Enter Office" id="Office" name="office" required>
						<label  class="label"for="jobTitle">Job Title:</label>
						<div id="JobTitleError"></div>
						<input type="text" placeholder="Enter job Title" id="JobTitle" name="JobTitle" required>
						<label  class="label" for="skypeId">Skype Id:</label>
						<input type="text" placeholder="Enter Skype ID" name="skypeId" required>
						<br>
						<button  type="button" class="btn" onclick="addNewEmployee()">Add Employee</button>
					</div>
					<div id="right-fields" class="right-details">
						<label class="label" for="lname">LastName:</label>
						<div id="LastNameError"></div>
						<input type="text" placeholder="Enter Last Name" name="lname" id="LastName" onchange="setPreferredName()" required>
						<label class="label" for="email">Email:</label>
						<div id="EmailError"></div>
						<input class="email" type="text" placeholder="Enter Email" name="email"  id="Email" required>
						<label class="label" for="dept">Department:</label>
						<div id="DepartmentError"></div>
						<input type="text" placeholder="Enter Department"  id="Department" name="dept" required>
						<label  class="label" for="phno">Phone Number:</label>
						<div id="PhoneNumberError"></div>
						<input type="text" placeholder="Enter Phone Number" id="PhoneNumber" name="phno" required>
						<label  class="label"  for="photo">Upload Photo:</label>
						<input  class="upload-pic" id="pic" type="file" accept="image/*" />
						<br>
						<br>
					  	<button type="button"  class="btn-cancel" onclick="closeForm()">Cancel</button>
					</div>
					</form>
				</div>
			</div>
			<div class="form-popup" id="editEmployeeForm">
				<form class="form-container" id="edit-employee-details" method="POST">
				<h2 class="add-emplyee-heading">Edit Employee Details</h2>
				<br>
				<div  id='edit-left-fields' class="left-details">
				  	<label class="label" for="fname">First Name:</label>
					<div id="NewFirstNameError"></div>
					<input type="text" placeholder="Enter First Name" name="fname" id="NewFirstName"  required>
					<label class="label" for="pname">Preferred Name:</label>
					<div id="NewPreferredNameError"></div>
					<input type="text" placeholder='Enter Preferred Name' name="pname" id="NewPreferredName"  disabled>
					<label  class="label"for="office">Office:</label>
					<div id="NewOfficeError"></div>
					<input type="text" placeholder="Enter Office" id="NewOffice" name="office" disabled>
					<label class="label" for="dept">Department:</label>
					<div id="NewDepartmentError"></div>
					<input type="text" placeholder="Enter Department"  id="NewDepartment" name="dept">
					<label  class="label" for="skypeId">Skype Id:</label>
					<div id="NewSkypeIdError"></div>
					<input type="text" placeholder="Enter Skype ID" name="skypeId"  id="NewSkypeId" disabled>
					<br>
					<br>
					<button  type="button" class="btn" onclick="SaveChanges()">Save Changes</button>
				</div>
				<div id='edit-right-fields' class="right-details"	>
					<label class="label" for="lname">Last Name:</label>
					<div id="NewLastNameError"></div>
					<input type="text" placeholder="Enter Last Name" name="lname" id="NewLastName"  required>
					<label class="label" for="email">Email:</label>
					<div id="NewEmailError"></div>
					<input class="email" type="text" placeholder="Enter Email" name="email"  id="NewEmail" disabled>
					<label  class="label"for="jobTitle">Job Title:</label>
					<div id="NewJobTitleError"></div>
					<input type="text" placeholder="Enter job Title" id="NewJobTitle" name="JobTitle" required>
					<label  class="label" for="phno">Phone Number:</label>
					<div id="NewPhoneNumberError"></div>
					<input type="text" placeholder="Enter Phone Number" id="NewPhoneNumber" name="phno" disabled>
					<label  class="label" for="photo">Upload Photo:</label>
					<div id="NewProfilePicError"></div>
					<input  class="upload-pic1" id="NewProfilePic" type="file" onchange="changeSelectedFile()">
					<button type="button" class="upload-image"><label for="NewProfilePic">Upload Image</label></button>
					<label id="selectedFile"></label>
					<br>
					<br>
					<br>
					<button  type="button" class="btn-cancel" onclick="closeEditEmployeeForm()">Cancel</button>
				</div>
			    </form>
			</div>
			<script>
					var clickedCard;
					var clickedButton='';
					var employeeData=
						[
						{
							"firstName":"Anthony",
							"lastName":"Morris",
							"preferredName" :"Anthony",
							"email":"anthony123@gmail.com",
							"jobTitle":"SharePoint Practice Head",
							"office":"Seattle",
							"department":"IT",
							"phoneNumber":"8464832529",
							"skypeId":"antony123",
							"pic":"Antony.png"
					
						},
						{
							"firstName":"Helen",
							"lastName":"Zimmerman",
							"preferredName" :"Helen",
							"email":"Helen@gmail.com",
							"jobTitle":"Operations Manager",
							"office":"India",
							"department":"IT",
							"phoneNumber":"98738738888",
							"skypeId":"Helen124",
							"pic":"Helen.png"
					
						},
						{
							"firstName":"Jonathon",
							"lastName":"Smith",
							"preferredName" :"Jonathon",
							"email":"john@gmail.com",
							"jobTitle":"Product Manager",
							"office":"Seattle",
							"department":"IT",
							"phoneNumber":"987834807",
							"skypeId":"jonathon@123",
							"pic":"Jonathan.png"

						},
						{
							"firstName":"Tami",
							"lastName":"Hopkins",
							"preferredName" :"Tami",
							"email":"Tami@123@gmail.com",
							"jobTitle":"LeadEngineer-Dot Net",
							"office":"India",
							"department":"IT",
							"phoneNumber":"8975834957",
							"skypeId":"Tami@123",
							"pic":"Tami.png"

						},
						{
							"firstName":"Franklin",
							"lastName":"Humark",
							"preferredName" :"Franklin",
							"email":"franklin@123",
							"jobTitle":"Network Engineer",
							"office":"Seattle",
							"department":"IT",
							"phoneNumber":"734987090",
							"skypeId":"Franklin@123",
							"pic":"franklin.png"

						},
						{
							"firstName":"Angela",
							"lastName":"Bailey",
							"preferredName" :"Angela",
							"email":"Angela@123",
							"jobTitle":"Talent Manager Jr",
							"office":"Seattle",
							"department":"HR",
							"phoneNumber":"734987090",
							"skypeId":"Angela@123",
							"pic":"Angela.png"
						},
						{
							"firstName":"Robert",
							"lastName":"Mitchell",
							"preferredName" :"Robert",
							"email":"Robert@123",
							"jobTitle":"Software Engineer",
							"office":"Seattle",
							"department":"IT",
							"phoneNumber":"734987090",
							"skypeId":"Robert@123",
							"pic":"Robert.png"
						},
						{
							"firstName":"Olivia",
							"lastName":"Humark",
							"preferredName" :"Olivia",
							"email":"olivia@123",
							"jobTitle":"UI designer",
							"office":"Seattle",
							"department":"UX",
							"phoneNumber":"734987090",
							"skypeId":"Olivia@123",
							"pic":"Olivia.png"
						}
						]
					appendData(employeeData);
					function appendData(data) 
						{
							document.getElementById("myData").innerHTML='';
							var mainContainer = document.getElementById("myData");
							var dept={};
							var offices={};
							var jobs={};
							for (var i = 0; i < data.length; i++) 
								{
									if(data[i].department in dept)
										dept[data[i].department]+=1;
									else
									dept[data[i].department]=1;

									if(data[i].office in offices)
										offices[data[i].office]+=1;
									else
									offices[data[i].office]=1;

									if(data[i].jobTitle in jobs)
										jobs[data[i].jobTitle]+=1;
									else
									jobs[data[i].jobTitle]=1;
								}
								
								if(Object.keys(jobs).length>6)
								document.getElementById("job-view").style.display='block';
								
							
								var div = document.createElement("div");
								div.className="left-panel";
								var count=0;
								for (const key of Object.keys(dept)) 
								{
									if(count<6){
									div.innerHTML+=`<p class='filters' style='display:block;' onclick='getFilterData("${key}","department")'> ${key} (${dept[key]})</p>`;
								}
									else{
									div.innerHTML+=`<p class='filters' style='display:none;' onclick='getFilterData("${key}","department")'> ${key} (${dept[key]})</p>`;

									}
								}	
								div.innerHTML+="<br><a id='dept-view' href='#'><b>view more departments</b></a><br><br><h3> Office </h3><br>";
								for (const key of Object.keys(offices)) 
								{
									if(count<6){
									div.innerHTML+=`<p class='filters' style='display:block;' onclick='getFilterData("${key}","office")'> ${key} (${offices[key]})</p>`;
									}
									else{
									div.innerHTML+=`<p class='filters' style='display:none;'  onclick='getFilterData("${key}","office")'> ${key} (${offices[key]})</p>`;

									}
								}
								div.innerHTML+="<br><br><br> <h3> Job Titles </h3><br>";
								for (const key of Object.keys(jobs))
								{
									if(count<6){
									div.innerHTML+=`<p class='filters' style='display:block;' onclick='getFilterData("${key}","jobTitle")'> ${key} (${jobs[key]})</p>`;
									}
									else{
										div.innerHTML+=`<p class='filters' style='display:none;' onclick='getFilterData("${key}","jobTitle")'> ${key} (${jobs[key]})</p>`;
									}
									count+=1;
								}
								mainContainer.appendChild(div);
						}

					
					const buttonsContainer = document.getElementById("buttonsContainer");

					let button = document.createElement("button");
					button.innerHTML ="&#xF007";
					button.setAttribute("id","personButton");
					button.addEventListener("click", function() {
						document.getElementById("personButton").style.backgroundColor="#69BA00";
						displayCards(employeeData);
						for(let j=65;j<91;j++)
						document.getElementById(j).style.backgroundColor="#00B1FC";
					});
					document.getElementById("buttonsContainer").appendChild(button);
					for (let i = 65; i < 91; i++) 
					{
						const button = document.createElement("button");
						button.id=i;
						button.innerText = String.fromCharCode(i);
						button.addEventListener("click", function() {
						startingLetterNames=[];
						for(let j=65;j<91;j++)
						{
							document.getElementById(j).style.backgroundColor="#00B1FC";
							document.getElementById(j).className="inActive";
						}
						document.getElementById("personButton").style.backgroundColor="#00B1FC";
						button.style.backgroundColor="#69BA00";
						button.className="Active";
						getSearchValue();
						
						
					})
						buttonsContainer.appendChild(button);
					}
					let filteredData=[];
					function getFilterData(key,filterType)
					{
						filteredData=[];
						clearAll();
						for(var person=0;person<employeeData.length;person++)
						{
							if(employeeData[person][filterType]==key)
								{
									filteredData.push(employeeData[person]);
								}
								
						}
						
						displayCards(filteredData);
						
					}
					
					function getSearchValue()
					{
						var requiredData=employeeData;
						var filterValue = getFilterValue();
						var searchValue = document.getElementById("search").value;
						var clickedButton=document.querySelector('.Active');
						if(clickedButton!=null)
							clickedButton=clickedButton.innerHTML;

						else
						    clickedButton='';
						if(filteredData.length!=0)
							requiredData=filteredData;
						filterNames=[];
						for(var person=0;person<requiredData.length;person++)
						{
							var v1=requiredData[person][filterValue].toLowerCase();
							var v2=searchValue.toLowerCase();
							if(clickedButton=='')
							{
								if(v1.includes(v2))
								{
									filterNames.push(requiredData[person]);
								}
							}
							else
							{
								if(v2!='')
								{
									if(((requiredData[person].firstName.charAt(0).toLowerCase())==clickedButton.toLowerCase()) && v1.includes(v2))
									{
										filterNames.push(requiredData[person]);
									}
								
								}
								else
								{
									if((requiredData[person].firstName.charAt(0).toLowerCase())==clickedButton.toLowerCase())
									{
										filterNames.push(requiredData[person]);
									}

								}

							}	
							
						}
						
						displayCards(filterNames);
					}
					displayCards(employeeData);
					
					function displayUserName()
					{
						document.getElementById("userName").innerHTML=employeeData[0].firstName+" "+employeeData[0].lastName;
					}
					function clearAll()
					{
						document.getElementById("personButton").style.backgroundColor="#69BA00";
						displayCards(employeeData);
						for(let j=65;j<91;j++)
						document.getElementById(j).style.backgroundColor="#00B1FC";
						document.querySelector('.search').value='';
					}
					function getFilterValue()
					{
						return document.getElementById("filter").value;	
						
					}
					function displayCards(data)
					{
						displayUserName();
						document.getElementById("cardsContainer").innerHTML='';
						const cardsContainer = document.getElementById("cardsContainer");
						if(data.length==0)
						cardsContainer.innerHTML="<h1>No Records Found</h1>";
						for (let i = 0; i <data.length; i++) 
						{
							const card = document.createElement("div");
							card.className="card";
							var img = document.createElement('img'); 
							img.className="image";
							img.src = data[i].pic; 
							card.appendChild(img);
							const details = document.createElement("div");
							details.innerHTML="<h3>"+data[i].firstName+" " +data[i].lastName+"</h3>"+
							"<p class=\"title\">"+data[i].jobTitle+"</p>"+ "<p class=\"title\">"+data[i].department+" Department"+"</p>"+ "<p class=\"title\">"	+"<p class=\"extras\">&#xf098;&nbsp &#xf0e0;&nbsp &#xf075;&nbsp &#xf005;&nbsp &#xf004;</p>";
							details.className="details";
							card.appendChild(details);
							
							var img1 = document.createElement('img1'); 
							img1.className="image1";
							img1.src = "options.png"; 
							card.appendChild(img1);


							card.addEventListener("click", function() { 
								clickedCard=data[i];
								openeditEmployeeForm(data[i]);
							});
							cardsContainer.appendChild(card);
						}
					}
					function setPreferredName()
					{
					var Name=document.getElementById("FirstName").value; 
					var LName=document.getElementById("LastName").value; 
					document.getElementById("PreferredName").value=Name+' '+LName;
					}
					var error='';
					var flag=0;
					function changeSelectedFile()
					{
						var filePath = document.getElementById("NewProfilePic").value;
						const fileparts=filePath.split("\\");
						var fileName=fileparts[fileparts.length-1];
						document.getElementById("selectedFile").innerHTML=fileName;
					}
					function validate(idName)
					
					{
											
						var Name=document.getElementById(idName).value;
						var errorDivision=idName+"Error"; 
						NameErr=document.getElementById(errorDivision);
						NameErr.innerHTML="";
						if(Name=="")
						{
								NameErr.innerHTML="Required";
								flag=1;
						}
						
						else if(idName.includes("FirstName")||idName.includes("LastName")||idName.includes("PreferredName")||idName.includes("Office")||idName.includes("Department")||idName.includes("JobTitle"))
						{
							validName=/^[A-Za-z ]+$/;
							if(!validName.test(Name))
							{
								NameErr.innerHTML=idName+" can only be letters<br>";
								flag=1;
							}
								
						}
						else if (idName=="Email")
						{
							validName=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
							if(!validName.test(Name))
							{
								NameErr.innerHTML="Email format not supported";
								flag=1;
							}
								
						}
						else if(idName=="PhoneNumber")
						{
							validName=/^[0-9]+$/;
							if(!validName.test(Name) || Name.length!=10)
							{
								NameErr.innerHTML=idName+"must be only digits of length 10<br>";
								flag=1;
							}
						}
						if (flag==0)
							NameErr.innerHTML='';
					}
					function displayAll()
					{
						document.getElementById("job-view").style.display='none';
						let elements=document.getElementsByClassName('filters');
						for (i in elements)
						{
							console.log(elements[i]);
							elements[i].style.display='block';
							
						}
					}
					function addNewEmployee()
					{
					

						flag=0;
						validate("FirstName");
						validate("LastName");
						validate("PreferredName");
						validate("Email");
						validate("JobTitle");
						validate("Office");
						validate("Department");
						validate("PhoneNumber");
						if(flag==0)
						{
						var object={};
						object["firstName"]=document.getElementById("FirstName").value;
						object["lastName"]=document.getElementById("LastName").value;
						object["preferredName"]=document.getElementById("PreferredName").value;
						object["phoneNumber"]=document.getElementById("PhoneNumber").value;
						object["email"]=document.getElementById("Email").value;
						object["jobTitle"]=document.getElementById("JobTitle").value;
						object["office"]=document.getElementById("Office").value;
						object["department"]=document.getElementById("Department").value;
						if(document.getElementById("SkypeId")!=null)
							object["skypeId"]=document.getElementById("SkypeId").value;
						else
							object["skypeId"]='';

						var filePath = document.getElementById("pic").value;
						const fileparts=filePath.split("\\");
						var fileName=fileparts[fileparts.length-1];
						object["pic"]=fileName;
						employeeData.push(object);
						displayCards(employeeData);
						appendData(employeeData);
						closeForm();
						}
					}
					function serialize (data) 
					{
						let obj = {};
						for (let [key, value] of data)
						{
							if (obj[key] !== undefined) 
							{
								if (!Array.isArray(obj[key]))
								{
									obj[key] = [obj[key]];
								}
								obj[key].push(value);
							} 
							else 
								obj[key] = value;
						
						}
						return obj;
					}
					function openForm() 
					{
					
					document.getElementById("container").style.filter="blur(12px)";
					document.getElementById("myForm").style.display = "block";
					document.getElementById("employee-details").reset();
					}
					function closeForm() 
					{
						
						document.getElementById("container").style.removeProperty('filter');
						document.getElementById("myForm").style.display = "none";
						let errorDivisions =document.getElementById("left-fields").children;
						for(let child of errorDivisions)
						{
							if(child.id.includes('Error'))
							{
								child.innerHTML=''; 
							}
						}
						errorDivisions =document.getElementById("right-fields").children;
						for(let child of errorDivisions)
						{
							if(child.id.includes('Error'))
							{
								child.innerHTML=''; 
							}
						}
					}
					function openeditEmployeeForm(data)
					{
						document.getElementById("container").style.filter="blur(12px)";
						document.getElementById("editEmployeeForm").style.display = "block";
						document.getElementById("NewFirstName").value=data.firstName;
						document.getElementById("NewLastName").value=data.lastName;
						document.getElementById("NewPreferredName").value=data.preferredName;
						document.getElementById("NewEmail").value=data.email;
						document.getElementById("NewJobTitle").value=data.jobTitle;
						document.getElementById("NewOffice").value=data.office;
						document.getElementById("NewDepartment").value=data.department;
						document.getElementById("NewPhoneNumber").value=data.phoneNumber;
						document.getElementById("NewSkypeId").value=data.skypeId;
						document.getElementById("selectedFile").innerHTML=data.pic;
					}
					function SaveChanges()
					{
						flag=0;
						validate("NewFirstName");
						validate("NewLastName");
						validate("NewPreferredName");
						validate("NewEmail");
						validate("NewJobTitle");
						validate("NewOffice");
						validate("NewDepartment");
						validate("NewPhoneNumber");
						
						appendData(employeeData);
						if(!flag)
						{
						clickedCard["firstName"]=document.getElementById("NewFirstName").value;
						clickedCard["lastName"]=document.getElementById("NewLastName").value;
						clickedCard["PreferredName"]=document.getElementById("NewPreferredName").value;
						clickedCard["email"]=document.getElementById("NewEmail").value;
						clickedCard["jobTitle"]=document.getElementById("NewJobTitle").value;
						clickedCard["office"]=document.getElementById("NewOffice").value;
						clickedCard["department"]=document.getElementById("NewDepartment").value;
						clickedCard["phoneNumber"]=document.getElementById("NewPhoneNumber").value;
						clickedCard["skypeId"]=document.getElementById("NewSkypeId").value;
						clickedCard["pic"]=document.getElementById("selectedFile").innerHTML;
						displayCards(employeeData);
							
							closeEditEmployeeForm();
						}	
					}										
					function closeEditEmployeeForm() 
					{
					document.getElementById("container").style.removeProperty('filter');
					document.getElementById("editEmployeeForm").style.display = "none";
					let errorDivisions =document.getElementById("edit-left-fields").children;
						for(let child of errorDivisions)
						{
							if(child.id.includes('Error'))
							{
								child.innerHTML=''; 
							}
						}
						errorDivisions =document.getElementById("edit-right-fields").children;
						for(let child of errorDivisions)
						{
							if(child.id.includes('Error'))
							{
								child.innerHTML=''; 
							}
						}
				}
			</script>						
	</body>
</html>
